# 输入法

## 输入法框架

下面将使用 fcitx5 作为输入法框架 (Input Method Framework, IMF), 该框架有以下优点:

- **现代**: 对 Wayland 支持良好.
- **轻量**: 相比其他 IMF 延迟更低, 资源占用更少.

其他 IMF 有 ibus/scim/uim.

### 安装

通过下面命令安装 fcitx5 框架:

```sh
sudo pacman -S fcitx5-im
```

### 环境配置

#### Wayland

详情请参考 [Fcitx5 - Wiki](https://fcitx-im.org/wiki/Using_Fcitx_5_on_Wayland).

部分应用程序依然需要设置环境变量, 比如使用 flatpak 安装的 WeChat:

```sh
sudo flatpak override com.tencent.WeChat \
  --env=GTK_IM_MODULE=fcitx \
  --env=QT_IM_MODULE=fcitx \
  --env=XMODIFIERS=@im=fcitx
```

#### X11

向文件 `/etc/profile` 追加以下内容:

```sh title="/etc/profile"
export GTK_IM_MODULE=fcitx
export QT_IM_MODULE=fcitx
export SDL_IM_MODULE=fcitx
export XMODIFIERS=@im=fcitx
export GLFW_IM_MODULE=ibus
# export WEBKIT_IM_MODULE=fcitx
```

或者向文件 `/etc/environment` 追加以下内容:

```txt title="/etc/environment"
GTK_IM_MODULE=fcitx
QT_IM_MODULE=fcitx
SDL_IM_MODULE=fcitx
XMODIFIERS=@im=fcitx
GLFW_IM_MODULE=ibus
```

更详细的环境变量修改方式请参考 [ArchWiki](https://wiki.archlinux.org/title/Environment_variables).

## 输入法引擎

安装输入法框架后还需要安装一个中文输入法引擎才能使用中文输入法, 目前主要有两个选择:

- **fcitx5-rime**: 中州韻輸入法引擎 高度可自定义.
- **fcitx5-chinese-addons**: fcitx5 官方开发的输入法引擎, 开箱即用.

### Rime 引擎

通过下面命令安装 Rime 引擎:

```sh
sudo pacman -S fcitx5-rime
```

建议安装[预制方案](#预制方案)或安装词库:

```sh
sudo pacman -S rime-pinyin-zhwiki
```

#### 配置

Rime 配置文件路径:

- **Linux**:
    - **fcitx5**: `~/.local/share/fcitx5/rime`.
    - **fcitx**: `~/.config/fcitx/rime/`.
    - **ibus**: `~/.config/ibus/rime`.
- **Windows**: `%APPDATA%\Rime`. (未验证)
- **macOS**: `~/Library/Rime`. (未验证)

使用输入法时按 `F4` 或 `Ctrl` `` ` `` 可以对基本设置进行修改.

#### 预制方案

下面为推荐的 Rime 预制方案.

##### 雾凇拼音 (rime-ice)

[雾凇拼音](https://github.com/iDvel/rime-ice)提供了一套开箱即用的完整**拼音**配置, 包括简体词库.

通过以下命令进行安装:

```sh
paru -S rime-ice-git
```

在配置目录下创建文件 `default.custom.yaml` 并写入下面内容:

```yml
patch:
  __include: rime_ice_suggestion:/
```

##### 薄荷输入法 (oh-my-rime)

[薄荷输入法](https://github.com/Mintimate/oh-my-rime)提供了一套开箱即用的完整配置, 包括简体词库和主题.

### fcitx5-chinese-addons 引擎

通过下面命令安装 fcitx5-chinese-addons 引擎:

```sh
sudo pacman -S fcitx5-chinese-addons 
```

建议安装词库:

```sh
sudo pacman -S fcitx5-pinyin-zhwiki
```

## 主题 (Theme)

通常也称之为皮肤.

![效果图](assets/fcitx5-theme-mint.webp){ width=70% }  

[薄荷输入法主题](https://github.com/witt-bit/fcitx5-theme-mint)可以通过下面命令安装:

```sh
paru -S fcitx5-theme-mint
```

然后在 `~/.config/fcitx5/conf/classicui.conf` 文件中添加下面内容以指定主题:

```conf title="~/.config/fcitx5/conf/classicui.conf"
Theme=mint-green-dark # mint-green-light
```

### 其他

- [类 Windows 10 输入法的主题](https://github.com/hosxy/Fcitx5-Material-Color).
- [类 Windows 10 输入法的主题](https://github.com/thep0y/fcitx5-themes-candlelight).
- [GitHub 上的主题](https://github.com/search?q=fcitx5+theme&type=Repositories).

## 词库 (Dictionaries)

- [imewlconverter](https://github.com/studyzy/imewlconverter): 词库转换工具.
- [QQ拼音词库](http://cdict.qq.pinyin.cn/v1/).
- [搜狗标准词库 - Archive](https://web.archive.org/web/20240808170726/https://pinyin.sogou.com/dict/detail/index/11640).
- <https://github.com/felixonmars/fcitx5-pinyin-zhwiki>.
- <https://github.com/thunlp/THUOCL>.
- <https://github.com/Iorest/rime-dict>.

## 参见

- [Fcitx5 (简体中文) - ArchWiki (archlinux.org)](https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)).
